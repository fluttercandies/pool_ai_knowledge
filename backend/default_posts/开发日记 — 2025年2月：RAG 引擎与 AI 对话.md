---
tags: 开发日记,RAG,AI对话,FAISS
language: zh-CN
---

## 2025年2月 — RAG 引擎与 AI 对话

### 2月3日 — OpenAI Embedding 接入

今天接入了 OpenAI 的 `text-embedding-ada-002` 模型来生成文本向量。每篇文章转成 `"标题. 内容"` 格式后送入模型，得到 1536 维的向量。

测试了一下效果，语义理解确实比关键词搜索强很多。比如搜索"怎么部署"能找到标题是"安装指南"的文章。

### 2月10日 — FAISS 向量索引集成

把 FAISS 集成进来了，使用 `IndexFlatL2` 做精确 L2 距离搜索。目前文章量不大，精确搜索完全够用。

工作流程：
1. 服务启动时从 MySQL 加载所有文章
2. 批量生成 embedding 向量
3. 存入 FAISS 内存索引
4. 查询时也生成 embedding，然后做 top-k 近邻搜索

发现一个问题：文章更新后向量索引没同步。加了个触发机制，文章增删改时自动重建索引。

### 2月17日 — Google Gemini Agent 对话

集成了 Google ADK（Agent Development Kit），创建了知识库 Agent。Agent 的工作方式：
1. 用户提问
2. Agent 调用 `search_knowledge_base` 工具函数
3. 工具函数走 FAISS 检索返回相关文章
4. Agent 基于检索到的内容生成回答

测试效果不错，问"项目用了什么数据库"，能准确回答"MySQL"并引用相关文章。

### 2月24日 — 多语言支持

添加了多语言支持。每篇文章有 `language` 字段（zh-CN、en 等），搜索和对话时可以指定语言过滤。

AI 对话也支持指定回复语言，通过在 prompt 末尾追加语言指令实现。
