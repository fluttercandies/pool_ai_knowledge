---
tags: 开发日记,Flutter,移动端,性能优化
language: zh-CN
---

## 2025年4月 — 移动端与优化

### 4月7日 — Flutter 项目启动

开始做移动端，选择 Flutter 实现跨平台（Android + iOS + 桌面）。

初始化了项目结构，引入了核心依赖：
- `flutter_riverpod` — 状态管理
- `window_manager` — 桌面端窗口控制
- `dio` — HTTP 请求

桌面端窗口默认 1200x800，最小 800x600，体验接近原生应用。

### 4月14日 — App 核心功能开发

完成了 App 的核心页面：
- 首页 — 最新文章 + 快速搜索入口
- 文章浏览 — 列表 + 详情（Markdown 渲染）
- AI 对话 — 与知识库 Agent 聊天
- 设置 — API 地址配置、语言切换

把 API Host 放在 `assets/app_config.json` 配置文件中，这样打包后可以通过脚本修改，用户不需要在服务器上安装 Flutter 环境。

### 4月21日 — 性能优化

做了一轮性能优化：

**后端优化：**
- FAISS 索引改为增量更新，避免每次文章变更都全量重建
- 数据库连接池配置调优（pool_pre_ping + pool_recycle）
- API 响应添加了 gzip 压缩

**前端优化：**
- 文章列表懒加载，减少首屏请求
- 图片添加了 7 天浏览器缓存
- Nginx 静态资源配置了 CDN 友好的 Cache-Control

### 4月28日 — APK 重打包方案设计

设计了 APK 重打包方案：开发机构建模板 APK，部署脚本用 apktool 反编译后修改 app_name 和 api_host，重新签名后托管在 Nginx 上供下载。

这样用户部署后端后就能直接提供 App 下载链接，不需要在服务器上装 Flutter。
